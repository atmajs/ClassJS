/*!
 * ClassJS v1.1.73
 * Part of the Atma.js Project
 * http://atmajs.com/
 *
 * MIT license
 * http://opensource.org/licenses/MIT
 *
 * (c) 2012, 2016 Atma.js and other contributors
 */
!function(t,n){"use strict";function e(){return n(i,r)}var r,i="undefined"==typeof window||null==window.navigator?global:window;return r=t||i,"function"==typeof define&&define.amd?define(e):(e(),void("undefined"!=typeof module&&(module.exports=r.Class)))}(this,function(t,n){"use strict";var e,r,i,o,u,l,s,c,f,a=Array.prototype.slice,h=Array.prototype.sort,p={ModelHost:null},v="__$class__";!function(){e=function(t){return"function"==typeof t},r=function(t){return null!=t&&"object"==typeof t},l=function(t){return null!=t&&"Date"===t.constructor.name&&t instanceof Date},i=function(t){return null!=t&&"number"==typeof t.length&&"function"==typeof t.slice},o=i,u=function(t){return"string"==typeof t},s=function(t){return"string"==typeof t&&""!==t},c=function(t){return null!=t&&("object"==typeof t&&t.constructor===Object)},f=function(n){return void 0===n||n===t}}();var d,y,g;!function(){d=function(t,n){if(y(t))for(var e=0,r=t.length;e<r;e++)n(t[e],e);else n(t)},y=function(t){return null!=t&&"object"==typeof t&&"number"==typeof t.length&&"function"==typeof t.splice},g=function(t,n){for(var e=t.length,r=-1;++r<e;)n(t[r])===!0&&(t.splice(r,1),r--,e--)},"function"!=typeof Array.isArray&&(Array.isArray=function(t){return t instanceof Array||null!=t&&"object"==typeof t&&(void 0!==t.length&&"function"==typeof t.slice)})}();var _,w,b,j,S,m;!function(){function n(t,n){if(null==n||"object"!=typeof n)return n;var e=this,i=e[t];return i[v]&&i.toJSON?r(i[v],n):n}function r(t,n){var e={};return e.json=n,e[v]=t,e}function i(t,n){var e;return null!=n&&"object"==typeof n&&n[v]&&(e=W(n[v]),"function"==typeof e?n=new e(n.json):console.error("<class:parse> Class was not registered",n[v])),n}function o(n,e){"function"==typeof n&&(n=n.prototype),null==e&&(e={});var r,i,u;for(i in n)if(u=n[i],r=null==u?null:typeof u,"function"!==r){var l=i.charCodeAt(0);if(!(95===l&&"_id"!==i||l>=65&&l<=90))if("object"!==r)e[i]=r;else{var s=u.constructor,c=s&&s.name;if("Object"!==c&&c&&t[c]===s){e[i]=c;continue}e[i]=o(u)}}return n.__proto__&&o(n.__proto__,e),e}_=function(t,n){J(p.ModelHost||W.Model,t,n)},w=function(t){return E(p.ModelHost||W.Model,t)},b=function(t,n){var r=u(t)?w(t):t;return!e(r)&&console.error("<class:patch> Not a Function",t),n.Base=r,r=W(n),u(t)&&_(t,r),r},j=function(t){return JSON.stringify(t,n)},S=function(t){return JSON.parse(t,i)},m=function(t){return o(t)}}();var O,A,x;!function(){function t(t,n){return function(e){var r=s(e),i=r[n];c(i)&&k(t,i)}}function n(t,n){if(null!=n){"function"==typeof t&&(t=t.prototype),"function"==typeof n&&(n=n.prototype);var e,r;for(e in n)"constructor"!==e&&(r=n[e],null!=r&&(t[e]=r))}}function i(t,n){var e;return e=t?function(n){var e=1===arguments.length&&h(n)?n:arguments;return U(t,this,e)}:q,function(){return this.super=e,U(n,this,arguments)}}function u(t,e,r,o,u,l){var s=o,c=o;s.constructor=t.prototype.constructor,null!=r&&(c[f]={},d(r,function(t){n(c[f],t)}),c=c[f]),null!=e&&(c[f]=e.prototype);for(var a in l)null==s[a]&&(s[a]=l[a]);for(var a in u)s[a]=i(s[a],u[a]);t.prototype=s}function l(t,e,r,o,u,l){if(null!=e){var s=function(){};s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t}null!=r&&d(r,function(e){delete e.constructor,n(t,e)});var c=t.prototype;k(c,l);for(var f in u)c[f]=i(c[f],u[f]);n(t,o)}function s(t){return e(t)?t.prototype:t}var f="__proto__",a=Object.prototype.toString,h=function(t){return"[object Arguments]"===a.call(t)};O=f in Object.prototype?u:l,A=function(t,n){if(null!=n)if(o(n))for(var i=n.length;--i>-1;)A(t,n[i]);else{var u;e(n)?u=n:r(n.Static)&&(u=n.Static),null!=u&&M(t,u)}},x=function(n,e,r){var i,o;for(i in n)o=n[i],c(o)&&(null!=e&&c(e.prototype[i])&&k(o,e.prototype[i]),null!=r&&d(r,t(o,i)))}}();var z,T,N="__$serialization";!function(){z=function(t){var n,e,r,i=this,o={};null==t&&(t=i[N]);var u;for(n in i)if(u=n,null!=t&&t.hasOwnProperty(n)&&(r=t[n],null!=r&&"object"==typeof r&&(r.key&&(u=r.key),r.hasOwnProperty("serialize")))){if(null==r.serialize)continue;o[u]=r.serialize(i[n])}else if(95!==n.charCodeAt(0)&&"Static"!==n&&"Validate"!==n&&(e=i[n],null!=e))if("_id"!==n){switch(typeof e){case"function":continue;case"object":if(l(e))break;var s=e.toJSON;if(null==s)break;o[u]=e.toJSON();continue}o[u]=e}else o[u]=e;return null!=i._id&&(o._id=i._id),o},T=function(){for(var t,n=this,e=n.length,r=0,i=new Array(e);r<e;r++){if(t=n[r],null!=t&&"object"==typeof t){var o=t.toJSON;if(o===z||o===T){i[r]=t.toJSON();continue}if(null==o){i[r]=z.call(t);continue}}i[r]=t}return i}}();var P,E,J,k,C,I,M,R;!function(){P=function(t){e(t)&&(t=t.prototype);for(var n,r,i=1,o=arguments.length;i<o;i++){n=e(arguments[i])?arguments[i].prototype:arguments[i];for(r in n)if("Static"!==r||null==t.Static)t[r]=n[r];else for(r in n.Static)t.Static[r]=n.Static[r]}return t},E=function(t,n){for(var e=n.split("."),r=e.length,i=-1;++i<r;){if(null==t)return null;t=t[e[i]]}return t},J=function(t,n,e){for(var r,i=n.split("."),o=i.length,u=-1;++u<o-1;)r=i[u],null==t[r]&&(t[r]={}),t=t[r];t[i[u]]=e},k=function(t,n){for(var e in n)null==t[e]&&(t[e]=n[e]);return t},C=function(t,n){if(null==t&&(t={}),null==n)return t;var e,r;for(r in n)e=n[r],null!=e&&(t[r]=e);return t},function(){function t(t,r,i){if(null==t)return{};if(null==r)return r;var o,u;for(u in r)i===!0&&null!=t[u]||(o=n(r,u),null!=o?void 0===o.value?e(t,u,o):t[u]=o.value:I(t,r.__proto__));return t}var n=Object.getOwnPropertyDescriptor,e=Object.defineProperty;return null==n?(I=C,void(M=k)):(I=function(n,e){return t(n,e,!1)},void(M=function(n,e){return t(n,e,!0)}))}(),function(){function t(t,e,o){var u,c,f,a;for(c in e)if(null==s||t!==o||s.hasOwnProperty(c)!==!1){switch(c.charCodeAt(0)){case 63:
//! accept falsy value
if(a=c.substring(1),f=t[a],!f)continue;if(u=n(f,e[c],o),null!=u)return u.setInvalidProperty(a),u;continue;case 45:if(a=c.substring(1),"object"==typeof t&&a in t)return i(a);continue}if(f=t[c],null==f)return r(c);if(u=n(f,e[c],o),null!=u)return u.setInvalidProperty(c),u}if(l)for(c in t)if(!(c in e||"?"+c in e))return i(c)}function n(n,i,l){if(null==i)return null;if("function"==typeof i){var s=i.call(l,n);return null==s||s===!0?null:s===!1?u():o(s)}if(null==n)return r();if("string"==typeof i){var c="string",f="number",a="boolean";switch(i){case c:return typeof n!==c||0===n.length?e(c):null;case f:return typeof n!==f?e(f):null;case a:return typeof n!==a?e(a):null}}if(i instanceof RegExp)return i.test(n)===!1?u():null;if(Array.isArray(i)){if(Array.isArray(n)===!1)return e("array");for(var s,h=-1,p=n.length;++h<p;)if(s=t(n[h],i[0]))return s.setInvalidProperty(h),s;return null}return typeof n!=typeof i?e(typeof n):"object"==typeof n?t(n,i):null}R=function(n){if(null==n)return u("object");s=null,l=!1;for(var e,r,i=arguments.length;--i>0;)switch(r=arguments[i],typeof r){case"string":null==s&&(s={}),s[r]=1;continue;case"boolean":l=r;continue;case"undefined":continue;default:if(1!==i)return u("validation argument at "+i);e=r;continue}return null==e&&(e=n.Validate),null==e?null:t(n,e,n)};var e,r,i,o,u,l=!1,s=null;!function(){function t(t,e,r){return r.type=t,r.property=null,r.setInvalidProperty=n,e.prototype=r,function(t){return new e(t)}}function n(t){return null==this.property?void(this.property=t):void(this.property=t+"."+this.property)}e=t("type",function(t){this.expect=t},{toString:function(){return"Invalid type."+(this.expect?" Expect: "+this.expect:"")+(this.property?" Property: "+this.property:"")}}),r=t("expect",function(t){this.property=t},{toString:function(){return"Property expected."+(this.property?"`"+this.property+"`":"")}}),i=t("unexpect",function(t){this.property=t},{toString:function(){return"Unexpected property"+(this.property?"`"+this.property+"`":"")}}),o=t("custom",function(t){this.error=t},{toString:function(){return"Custom validation: "+this.error+(this.property?" Property: "+this.property:"")}}),u=t("invalid",function(t){this.expect=t},{toString:function(){return"Invalid."+(this.expect?" Expect: "+this.expect:"")+(this.property?" Property: "+this.property:"")}})}()}()}();var $,H;!function(){function t(t,n,e){for(var r in n)e(E(t,r),n[r],r)}function n(t,n,e){for(var r in n)J(t,r,e(E(t,r),n[r],r))}function e(){var t=arguments;return function(n,e,r){for(var i,o=0,u=t.length;o<u;o++)if(i=t[o],i(n,e,r)===!1)return}}function r(t,n,e){if(y(t)===!1)return console.warn("<patch> property is not an array",e),!1}function i(t,n,e){if(n.hasOwnProperty("$each"))for(var r=0,i=n.$each.length;r<i;r++)t.push(n.$each[r]);else t.push(n)}function o(t,n,e){t[n>0?"pop":"shift"]()}function u(t,n,e){g(t,function(t){return f(t,n)})}function l(t,n,e){return t+n}function s(t,n,e){return n}function c(){}$=function(t,n){for(var e in n){var r=p[e];r?r[a](t,n[e],r[h]):console.error("Unknown or not implemented patcher",e)}return t},H=function(t){if(null==t)return"Undefined";var n=!1;for(var e in t)if(n=!0,null==p[e])return"Unsupported patcher: "+e;return n===!1?"No data":null};var f;!function(){f=function(t,n){for(var e in n)if(t[e]!==n[e])return!1;return!0}}();var a=0,h=1,p={$push:[t,e(r,i)],$pop:[t,e(r,o)],$pull:[t,e(r,u)],$inc:[n,l],$set:[n,s],$unset:[n,c],$bit:[n,c]}}();var D,U,X,q,L;!function(){function t(t,n){if(t.length!==n.length)return!1;for(var e=t.length,r=0;r<e;r++)if(t[r]!==n[r])return!1;return!0}D=function(t,n){return function(){return U(t,n,arguments)}},U=function(t,n,e){switch(e.length){case 0:return t.call(n);case 1:return t.call(n,e[0]);case 2:return t.call(n,e[0],e[1]);case 3:return t.call(n,e[0],e[1],e[2]);case 4:return t.call(n,e[0],e[1],e[2],e[3]);case 5:return t.call(n,e[0],e[1],e[2],e[3],e[4])}return t.apply(n,e)},X=function(t){var n=a.call(arguments,1);return function(){return arguments.length>0&&(n=n.concat(a.call(arguments))),U(t,null,n)}},q=function(){},L=function(n,e){if(0===n.length)return 0;for(var r=e.length,i=-1;++i<r;)if(t(e[i],n))return i+1;return e.push(n),e.length}}();var B={};(function(){!function(t){function n(){this._callbacks=[]}function e(t){function e(t){return function(){o+=1,i[t]=Array.prototype.slice.call(arguments),o===u&&r.done(i)}}var r=new n,i=[];if(!t||!t.length)return r.done(i),r;for(var o=0,u=t.length,l=0;l<u;l++)t[l].then(e(l));return r}function r(t,e){var i=new n;return 0===t.length?i.done.apply(i,e):t[0].apply(null,e).then(function(){t.splice(0,1),r(t,arguments).then(function(){i.done.apply(i,arguments)})}),i}function i(t){var n="";if("string"==typeof t)n=t;else{var e=encodeURIComponent;for(var r in t)t.hasOwnProperty(r)&&(n+="&"+e(r)+"="+e(t[r]))}return n}function o(){var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){t=new ActiveXObject("Microsoft.XMLHTTP")}return t}function u(t,e,r,u){function l(){v.abort(),d.done(a,"",v)}var v,d=new n,y=u&&u["Content-Type"]||p.contentType;try{v=o()}catch(t){return d.done(f,""),d}if(r)if("GET"===t)e+="?"+i(r),r=null;else switch(y){case s:r=i(r);break;case c:try{r=JSON.stringify(r)}catch(t){return d.done(h,""),d}break;default:r=i(r)}v.open(t,e),r&&v.setRequestHeader("Content-Type",y);for(var g in u)u.hasOwnProperty(g)&&v.setRequestHeader(g,u[g]);var _=p.ajaxTimeout;if(_)var w=setTimeout(l,_);return v.onreadystatechange=function(){if(_&&clearTimeout(w),4===v.readyState){var t=!v.status||(v.status<200||v.status>=300)&&304!==v.status;d.done(t,v.responseText,v)}},v.send(r),d}function l(t){return function(n,e,r){return u(t,n,e,r)}}var s="application/x-www-form-urlencoded",c="application/json",f=1,a=2,h=3;n.prototype.then=function(t,e){var r;return this._isdone?r=t.apply(e,this.result):(r=new n,this._callbacks.push(function(){var n=t.apply(e,arguments);n&&"function"==typeof n.then&&n.then(r.done,r)})),r},n.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var t=0;t<this._callbacks.length;t++)this._callbacks[t].apply(null,arguments);this._callbacks=[]};var p={Promise:n,join:e,chain:r,ajax:u,get:l("GET"),post:l("POST"),put:l("PUT"),del:l("DELETE"),patch:l("PATCH"),ENOXHR:f,ETIMEOUT:a,E_PREPAIR_DATA:h,ajaxTimeout:0,contentType:c};"function"==typeof define&&define.amd?define(function(){return p}):t.promise=p}(this)}).call(B),d(["get"],function(t){B[t]=function(n,e){this.promise[t](n).then(function(t,n,r){return t?void e.onError(t,n,r):void e.onSuccess(n)})}}),d(["del","post","put","patch"],function(t){B[t]=function(n,e,r){this.promise[t](n,e).then(function(t,n,e){r(t,n,e)})}});var F;!function(){F=function(n){if(this===W||null==this||this===t){var e=function(t){this[N]=C(this[N],n),F.call(this,t)};return e}null!=n&&(this.deserialize?this.deserialize(n):F.deserialize(this,n))},F.serialize=function(t){return e(t.toJSON)?t.toJSON():z.call(t,t[N])},F.deserialize=function(t,n){if(u(n))try{n=JSON.parse(n)}catch(e){return console.error("<json:deserialize>",n),t}if(i(n)&&e(t.push)){t.length=0;for(var o=0,l=n.length;o<l;o++)t.push(n[o]);return t}var s,c,f,a,h,p=t[N];if(null!=p){var v="__desAsKeys";if(s=p[v],null==s){s=p[v]={};for(f in p)"__desAsKeys"!==f&&p[f].hasOwnProperty("key")===!0&&(s[p[f].key]=f)}}for(f in n)a=n[f],c=f,null!=p&&(h=p.hasOwnProperty(f)?p[f]:null,s[f]&&(c=s[f]),null!=h&&(r(h)&&(h=h.deserialize),u(h)&&(h=w(h)),e(h)))?t[c]=a instanceof h?a:new h(a):t[c]=a;return t}}();var G,K=function(){function t(t){this.route=r(t)}function n(t){var n=o.exec(t);return n?{optional:"?"===(n[2]||n[3]),parts:[n[1],n[4]]}:(n=u.exec(t))?{optional:"?"===n[3],parts:[n[1],n[4],n[5]]}:(console.error("Paths breadcrumbs should be matched by regexps"),{parts:[t]})}function e(t,e){for(var r=t.split(e),i=0,o=r.length;i<o;i++)r[i]=n(r[i]);return r}function r(t){var n=/[^\:\{]\?[^:]/.exec(t),r=null;return n&&(n=n.index+1,r=t.substring(n+1),t=t.substring(0,n)),{path:e(t,"/"),query:null==r?null:e(r,"&")}}function i(t,n,e){for(var r,i,o,u=[],l=0,s=t.length;l<s;l++)if(o=t[l],i=o.parts.slice(0),null!=i[1]){if(r=i[1],i[1]=n[r],null!=i[1])u.push(i.join(""));else if(!o.optional)return console.error("Object has no value, for not optional part - ",r),null}else u.push(i[0]);return u.join(e)}t.prototype={constructor:t,create:function(t){var n,e;return n=i(this.route.path,t,"/"),null==n?null:this.route.query&&(e=i(this.route.query,t,"&"),null==e)?null:n+(e?"?"+e:"")},hasAliases:function(t){for(var n,e=0,r=this.route.path.length;e<r;e++)if(n=this.route.path[e].parts[1],n&&null==t[n])return!1;return!0}};var o=/^([^:\?]*)(\??):(\??)([\w]+)$/,u=/^([^\{\?]*)(\{(\??)([\w]+)\})?([^\s]*)?$/;return t}();!function(){function t(t,n,e,r){return null==r?t:(null!=n?U(r,t,n):e.push(r),t)}function n(t){t._done=null,t._fail=null,t._always=null}function e(t,n,e){if(null!=t){for(var r,i=t.length,o=-1;++o<i;)r=t[o],r&&U(r,n,e);t.length=0}}function r(t){return null!=t&&"object"==typeof t&&(t instanceof G||"function"==typeof t.done&&"function"==typeof t.fail)}G=function(){},G.prototype={_isAsync:!0,_done:null,_fail:null,_always:null,_resolved:null,_rejected:null,defer:function(){this._rejected=null,this._resolved=null},isResolved:function(){return null!=this._resolved},isRejected:function(){return null!=this._rejected},isBusy:function(){return null==this._resolved&&null==this._rejected},resolve:function(){var t=this._done,r=this._always;return this._resolved=arguments,n(this),e(t,this,arguments),e(r,this,[this]),this},reject:function(){var t=this._fail,r=this._always;return this._rejected=arguments,n(this),e(t,this,arguments),e(r,this,[this]),this},resolveDelegate:function(){return D(this.resolve,this)},rejectDelegate:function(){return D(this.reject,this)},then:function(t,n){return this.pipe(t,n)},done:function(n){return null!=this._rejected?this:t(this,this._resolved,this._done||(this._done=[]),n)},fail:function(n){return null!=this._resolved?this:t(this,this._rejected,this._fail||(this._fail=[]),n)},always:function(n){return t(this,this._rejected||this._resolved,this._always||(this._always=[]),n)},pipe:function(t){function n(t,n,e){return function(){if(null!=e){var i=e.apply(this,arguments);if(null!=i)return r(i)===!0?void i.pipe(t):void t[n](i)}t[n].apply(t,arguments)}}var e;if("function"==typeof t){e=new G;var i=t,o=arguments.length>1?arguments[1]:null;return this.done(n(e,"resolve",i)).fail(n(e,"reject",o)),e}e=t;for(var u,l=arguments.length,s=1===l,c=1===l,f=0;++f<l;)switch(u=arguments[f]){case"done":s=!0;break;case"fail":c=!0;break;default:console.error("Unsupported pipe channel",arguments[f])}return s&&this.done(e.resolveDelegate()),c&&this.fail(e.rejectDelegate()),this},pipeCallback:function(){var t=this;return function(n){if(null!=n)return void t.reject(n);var e=a.call(arguments,1);U(t.resolve,t,e)}}},G.run=function(t,n){var e=new G;return null==n&&(n=e),t.call(n,e.resolveDelegate(),e.rejectDelegate(),e),e},G.create=function(t){return function(){var n=a.call(arguments),e=new G;return n.unshift(e),U(t,this,n),e}},G.memoize=function(t){var n={},e=[];return function(){var r=a.call(arguments),i=L(e,r);if(null!=n[i])return n[i];var o=n[i]=new G;return r.unshift(o),U(t,this,r),o}}}();var V;!function(){function t(){var t,n,e=a.call(arguments),r=e.shift(),i=this._listeners[r],o=0;if(null==i)return this;for(n=i.length;o<n;o++)t=i[o],U(t,this,e),t._once===!0&&(i.splice(o,1),o--,n--);return this}V=function(){this._listeners={}},V.prototype={constructor:V,on:function(t,n){return null!=n&&(this._listeners[t]||(this._listeners[t]=[])).push(n),this},once:function(t,n){return null!=n&&(n._once=!0,(this._listeners[t]||(this._listeners[t]=[])).push(n)),this},pipe:function(t){var n,e=this;return function(){n=a.call(arguments),n.unshift(t),U(e.trigger,e,n)}},emit:t,trigger:t,off:function(t,n){var e=this._listeners[t];if(null==e)return this;if(1===arguments.length)return e.length=0,this;for(var r=e.length,i=-1;++i<r;)e[i]===n&&(e.splice(i,1),i--,r--);return this}}}();var Q,W=function(t){var n,e;if(u(t)){if(n=t,1===arguments.length)return w(t);e=arguments[1],e[v]=n}else e=t;var r=e.Base,o=e.Extends,l=e.Static,s=e.Construct,c=null,a=e.Store,h=e.Self,p=e.Override;return null!=r&&delete e.Base,null!=o&&delete e.Extends,null!=l&&delete e.Static,null!=h&&delete e.Self,null!=s&&delete e.Construct,null!=a&&(null==o?o=a:i(o)?o.unshift(a):o=[a,o],delete e.Store),null!=p&&delete e.Override,null==r&&null==o&&null==h?(void 0===e.toJSON&&(e.toJSON=z),c=null==s?function(){}:s,e.constructor=c.prototype.constructor,null!=l&&I(c,l),c.prototype=e,null!=n&&_(n,c),c):(c=function(){if(null!=o)for(var t=o instanceof Array,n=t?o.length:1,e=0,i=null;e<n;e++)i=t?o[e]:o,"function"==typeof i&&U(i,this,arguments);if(null!=r&&U(r,this,arguments),null!=h&&f(this)===!1)for(var u in h)this[u]=D(h[u],this);if(null!=s){var l=U(s,this,arguments);if(null!=l)return l}return this.super=null,this},null!=n&&_(n,c),null!=l&&I(c,l),null!=r&&A(c,r),null!=o&&A(c,o),x(e,r,o),O(c,r,o,e,p,{toJSON:z}),e=null,l=null,c)};!function(){function t(t,e,r){var i,o=n(t,e,!0);return r.done(function(){i=a.call(arguments),i.unshift(null),o.apply(null,i)}).fail(function(t){o(t)})}function n(t,n,r){null==r&&(r=!0),t._timeout&&clearTimeout(t._timeout),t.defer(),t._wait++,n&&(t._result||(t._result={}),n in t._result&&console.warn("<await>",n,"already awaiting"),t._result[n]=null);var i=X(e,t,n,r);return t._timeout=setTimeout(i,Q.TIMEOUT),i}function e(t,n,e){if(0===arguments.length)return t._wait=0,void t.reject("408: Timeout");if(0!==t._wait){var r=t._result;if(n){var i=a.call(arguments,3);r[n]={error:e?i.shift():null,arguments:i}}else e&&null!=arguments[3]&&(null==r&&(r=t._result={}),r.__error=arguments[3]);if(0===--t._wait){clearTimeout(t._timeout);var o,u,l=r&&r.__error;if(null==l)for(u in r)if(o=r[u],l=o&&o.error)break;if(l)return void t.reject(l,r);t.resolve(r)}}}Q=W({Extends:G.prototype,_wait:0,_timeout:null,_result:null,_resolved:[],Construct:function(){for(var n,e=arguments.length,r=-1;++r<e;)n=arguments[r],null!=n&&"function"==typeof n.done&&t(this,null,n)},delegate:function(t,e){return n(this,t,e)},deferred:function(n){return t(this,n,new G)},Static:{TIMEOUT:2e3}})}();var Y,Z,tt,nt,et={fetch:null,save:null,del:null,onSuccess:null,onError:null,Static:{fetch:function(t){return(new this).fetch(t)}}};!function(){function t(t,e){return function(){var r=null==t._rejected,i=r?t._resolved:t._rejected,l=r?o:u;n([l,t,e].concat(i))}}function n(t){l.trigger.apply(l,t)}var e,r,i="start",o="fulfilled",u="rejected",l=new V;Y=function(t){l.on(i,t),e=!0},Z=function(t,n){l.on(o,t).on(u,n),r=!0},tt=function(t){l.off(o,t).off(u,t).off(i,t)},nt=function(o){return G.prototype.defer.call(this),e&&n([i,this,o]),r&&this.always(t(this,o)),this}}(),W.Remote=function(){function t(t,e){var r;try{r=JSON.parse(e)}catch(e){return void n(t,e)}t.deserialize(r),t.resolve(t)}function n(t,n,r){var i;if("string"==typeof n&&e(r))try{i=JSON.parse(n)}catch(t){i=t}t.reject(i||n)}function e(t){var n=t.getResponseHeader(l);return null!=n&&n.toLowerCase().indexOf(s)!==-1}function o(t,o,u){return function(l,s,c){if(e(c))try{s=JSON.parse(s)}catch(e){return console.error("<XHR> invalid json response",s),n(t,e,c)}if(o&&o(l,s),l)return n(t,s,c);if("save"===u&&r(s)){if(i(t))for(var f=t.length,a=s.length,h=-1;++h<f&&h<a;)F.deserialize(t[h],s[h]);else t.deserialize(s);return t.resolve(t)}t.resolve(s)}}function u(t){return new c(t)}var l="content-type",s="json",c=function(t){this._route=new K(t)};return P(c,et,F,G,{defer:nt,serialize:function(){return i(this)?T.call(this):z.call(this)},deserialize:function(t){return F.deserialize(this,t)},fetch:function(t){return this.defer("fetch"),B.get(this._route.create(t||this),this),this},save:function(t){this.defer("save");var n=this.serialize(),e=this._route.create(this),r=this._route.hasAliases(this)?"put":"post";return B[r](e,n,o(this,t,"save")),this},patch:function(t){return this.defer("patch"),$(this,t),B.patch(this._route.create(this),t,o(this)),this},del:function(t){this.defer("del");var n=this.serialize(),e=this._route.create(this);return B.del(e,n,o(this,t)),this},onSuccess:function(n){t(this,n)},onError:function(t,e,r){n(this,e,r)}}),u.onBefore=Y,u.onAfter=Z,d(["get","post","put","delete"],function(t){u[t]=function(n,e){var r=e;null!=e.serialize&&(r=e.serialize()),null==r&&e.toJSON&&(r=e.toJSON());var i=new G;return B[t](n,r,o(i)),i}}),u}(),W.LocalStore=function(){function t(t,n){var e=t.create(n);localStorage.removeItem(e)}var n=function(t){this._route=new K(t)};P(n,et,F,G,{serialize:function(){var t=i(this)?T.call(this):z.call(this);return JSON.stringify(t)},deserialize:function(t){return F.deserialize(this,t)},fetch:function(t){var n=this._route.create(t||this),e=localStorage.getItem(n);if(null==e)return this.resolve(this);if(u(e))try{e=JSON.parse(e)}catch(t){return this.reject(t)}return this.deserialize(e),this.resolve(this)},save:function(t){var n=this._route.create(this),e=this.serialize();return localStorage.setItem(n,e),t&&t(),this.resolve(this)},del:function(n){if(null==n&&0!==arguments.length)return this.reject("<localStore:del> - selector is specified, but is undefined");if(y(this)===!1)return t(this._route,n||this),this.resolve();if(null==n){for(var e=0,r=this.length;e<r;e++)this[e]=null;return this.length=0,t(this._route,this),this.resolve()}var i=this.remove(n);return 0===i.length?this.resolve():this.save()},onError:function(t){this.reject({error:t})}});var e=function(t){return new n(t)};return e.prototype=n.prototype,e}(),W.bind=function(t){for(var n,e=arguments,r=1,i=arguments.length;r<i;r++)n=e[r],t[n]=t[n].bind(t);return t},W.cfg=function(t,n){if(u(t))return 1===arguments.length?p[t]:void(p[t]=n);if(r(t))for(var e in t)W.cfg(e,t[e])},W.Model={},W.Serializable=F,W.Deferred=G,W.EventEmitter=V,W.Await=Q,W.validate=R,W.stringify=j,W.parse=S,W.patch=b,W.properties=m,W.Collection=function(){function t(t,n){return n instanceof t?n:new t(n)}function n(){var t,n=arguments.length,i=arguments[n-1],o=arguments[n-2];return n>2&&(t=arguments[0]),i._ctor=o,P(i,r,e),null==t?W(i):W(t,i)}var e=function(){function n(t,n){if(null==n)return!1;if("function"==typeof n)return n(t);if("object"==typeof n){if(t.constructor===n.constructor&&t.constructor!==Object)return t===n;var e,r;for(var i in n){if(e=t[i],r=n[i],"string"==typeof r){var o=r[0],u=1;if("<"===o||">"===o)switch("="===r[1]&&(o+="=",u++),r=r.substring(u),o){case"<":if(e>=r)return!1;continue;case"<=":if(e>r)return!1;continue;case">":if(e<=r)return!1;continue;case">=":if(e<r)return!1;continue}}if(e!=r)return!1}return!0}return console.warn("No valid matcher",n),!1}function e(t,n){for(var e=this.length,r=-1;++r<e;)t.call(n||this,this[r],r);return this}var r={length:0,push:function(){for(var n=arguments.length,e=-1;++e<n;)this[this.length++]=t(this._ctor,arguments[e]);return this},pop:function(){var t=this[--this.length];return this[this.length]=null,t},shift:function(){if(0===this.length)return null;for(var t=this[0],n=this.length-1,e=0;e<n;e++)this[e]=this[e+1];return this[n]=null,this.length--,t},unshift:function(n){this.length++;for(var e=this.length;--e;)this[e]=this[e-1];return this[0]=t(this._ctor,n),this},splice:function(n,e){var r,i,o,u=this.length;if(n>=u)for(e=0,r=u,i=n;r<i;r++)this[r]=void 0;var l=e,s=n,c=n+l,f=arguments.length-2,a=u+f-l,h=c,p=u,v=a-u;if(0<v)for(r=p;--r>=h;)this[r+v]=this[r];if(0>v)for(r=h;r<p;)this[r+v]=this[r],r++;for(r=s,o=2;o<arguments.length;o)this[r++]=t(this._ctor,arguments[o++]);return this.length=a,this},slice:function(){return U(a,this,arguments)},sort:function(t){return h.call(this,t),this},reverse:function(){for(var t=a.call(this),n=this.length,e=-1;++e<n;)this[e]=t[n-e-1];return this},toString:function(){return a.call(this,0).toString()},each:e,forEach:e,where:function(t){for(var e,r=new this.constructor,i=0,o=this.length;i<o;i++)e=this[i],n(e,t)&&(r[r.length++]=e);return r},remove:function(t){for(var e=-1,r=[],i=0,o=this.length;i<o;i++)n(this[i],t)?r.push(this[i]):this[++e]=this[i];for(i=++e;i<o;i++)this[i]=null;return this.length=e,r},first:function(t){if(null==t)return this[0];var n=this.indexOf(t);return n!==-1?this[n]:null},last:function(t){if(null==t)return this[this.length-1];var n=this.lastIndexOf(t);return n!==-1?this[n]:null},indexOf:function(t,e){if(null==t)return-1;if(null!=e){if(e<0&&(e=0),e>=this.length)return-1}else e=0;for(var r=this.length;e<r;e++)if(n(this[e],t))return e;return-1},lastIndexOf:function(t,e){if(null==t)return-1;if(null!=e){if(e>=this.length&&(e=this.length-1),e<0)return-1}else e=this.length-1;for(;e>-1;e--)if(n(this[e],t))return e;return-1},map:function(t){for(var n=[],e=this.length,r=-1;++r<e;)n[r]=t(this[r]);return n},filter:function(t,n){for(var e=new this.constructor,r=this.length,i=-1;++i<r;)t.call(n||this,this[i])&&e.push(this[i]);return e}};return"undefined"!=typeof Symbol&&Symbol.iterator&&(r[Symbol.iterator]=function(){var t=this,n=-1;return{next:function(){return{value:t[++n],done:n>t.length-1}},hasNext:function(){return n<t.length}}}),r}(),r={toArray:function(){for(var t=new Array(this.length),n=0,e=this.length;n<e;n++)t[n]=this[n];return t},toJSON:T};return n}(),function(){var t,n;!function(){function e(t,n,e){return function(){t[e]=arguments;for(var r,i=0,o=n[e].length;i<o;i++)r=n[e][i],U(r,this,arguments);n[i]=null,t=null,n=null}}t=function(t){var n={},e=[],r=function(){var r=L(arguments,e);return null==n[r]?n[r]=U(t,this,arguments):n[r]};return r.clearArgs=function(){var t=L(arguments,e);n[t]=null},r.clearAll=function(){n={}},r},n=function(t){var n={},r={},i=[];return function(){var o=a.call(arguments),u=o.pop(),l=L(o,i);return n[l]?void U(u,this,n[l]):r[l]?void r[l].push(u):(r[l]=[u],o=a.call(o),o.push(e(n,r,l)),void U(t,this,o))}}}(),W.Fn={memoize:t,memoizeAsync:n}}(),n.Class=W});
//# sourceMappingURL=class.min.js.map