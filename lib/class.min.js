(function(t){function n(t,n){if(t instanceof Array)for(var e=0,r=t.length;r>e;e++)n(t[e],e);else n(t)}function e(t){"function"==typeof t&&(t=t.prototype);for(var n,e,r=1,o=arguments.length;o>r;r++){n="function"==typeof arguments[r]?arguments[r].prototype:arguments[r];for(e in n)if("Static"!==e||null==t.Static)t[e]=n[e];else for(e in t.Static)t.Static[e]=t.Static[e]}return t}"function"!=typeof Array.isArray&&(Array.isArray=function(t){return t instanceof Array?!0:null==t||"object"!=typeof t?!1:void 0!==t.length&&"function"==typeof t.slice});var r=function(){function t(t,n){if(null!=n){"function"==typeof t&&(t=t.prototype);for(var e in n)t[e]=n[e]}}function e(e,r,o,i){var u=i,s=i;u.constructor=e.prototype.constructor,null!=o&&(s.__proto__={},n(o,function(n){t(s.__proto__,n)}),s=s.__proto__),null!=r&&(s.__proto__=r.prototype),e.prototype=u}function r(e,r,o,i){if(null!=r){var u=function(){};u.prototype=r.prototype,e.prototype=new u,e.prototype.constructor=e}t(e.prototype,i),null!=o&&n(o,function(n){var r={};t(r,n),delete r.constructor;for(var o in r)e.prototype[o]=r[o]})}return"__proto__"in Object.prototype==!0?e:r}(),o=function(t,n){if(null!=n)if("function"!=typeof n)if(Array.isArray(n))for(var e=n.length,r=0;0!==e--;)o(t,n[r++]);else if(n.Static){n=n.Static;for(var i in n)n.hasOwnProperty(i)&&null==t[i]&&(t[i]=n[i])}else;else for(var i in n)"function"==typeof n[i]&&n.hasOwnProperty(i)&&null==t[i]&&(t[i]=n[i])},i={};n(["get","del"],function(t){i[t]=function(n,e){this.promise[t](n).then(function(t,n){return t?(e.onError(t,n),void 0):(e.onSuccess(n),void 0)})}}),n(["post","put"],function(t){i[t]=function(n,e,r){this.promise[t](n,e).then(function(t,n){r(t,n)})}}),function(t){function n(t,n){return function(){return t.apply(n,arguments)}}function e(){this._callbacks=[]}function r(t){function n(t){return function(n,e){o+=1,u[t]=n,s[t]=e,o===r&&i.done(u,s)}}for(var r=t.length,o=0,i=new e,u=[],s=[],l=0;r>l;l++)t[l]().then(n(l));return i}function o(t,n,r){var i=new e;return 0===t.length?i.done(n,r):t[0](n,r).then(function(n,e){t.splice(0,1),o(t,n,e).then(function(t,n){i.done(t,n)})}),i}function i(t){var n="";if("string"==typeof t)n=t;else{var e=encodeURIComponent;for(var r in t)t.hasOwnProperty(r)&&(n+="&"+e(r)+"="+e(t[r]))}return n}function u(){var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){t=new ActiveXObject("Microsoft.XMLHTTP")}return t}function s(n,r,o,s){function l(){a.abort(),f.done(t.promise.ETIMEOUT,"")}var a,c,f=new e;o=o||{},s=s||{};try{a=u()}catch(h){return f.done(-1,""),f}c=i(o),"GET"===n&&c&&(r+="?"+c,c=null),a.open(n,r),a.setRequestHeader("Content-type","application/x-www-form-urlencoded");for(var p in s)s.hasOwnProperty(p)&&a.setRequestHeader(p,s[p]);var d=t.promise.ajaxTimeout;if(d)var y=setTimeout(l,d);return a.onreadystatechange=function(){d&&clearTimeout(y),4===a.readyState&&(200===a.status?f.done(null,a.responseText):f.done(a.status,a.responseText))},a.send(c),f}function l(t){return function(n,e,r){return s(t,n,e,r)}}e.prototype.then=function(t,e){var r=n(t,e);this._isdone?r(this.error,this.result):this._callbacks.push(r)},e.prototype.done=function(t,n){this._isdone=!0,this.error=t,this.result=n;for(var e=0;this._callbacks.length>e;e++)this._callbacks[e](t,n);this._callbacks=[]};var a={Promise:e,join:r,chain:o,ajax:s,get:l("GET"),post:l("POST"),put:l("PUT"),del:l("DELETE"),ENOXHR:1,ETIMEOUT:2,ajaxTimeout:0};"function"==typeof define&&define.amd?define(function(){return a}):t.promise=a}(i);var u=function(){function t(t){this.route=r(t)}function n(t){var n=i.exec(t);return n?{optional:"?"===(n[2]||n[3]),parts:[n[1],n[4]]}:(n=u.exec(t))?{optional:"?"===n[3],parts:[n[1],n[4],n[5]]}:(console.error("Paths breadcrumbs should be match by regexps"),{parts:[t]})}function e(t,e){for(var r=t.split(e),o=0,i=r.length;i>o;o++)r[o]=n(r[o]);return r}function r(t){var n=/[^\:\{]\?[^:]/.exec(t),r=null;return n&&(n=n.index+1,r=t.substring(n+1),t=t.substring(0,n)),{path:e(t,"/"),query:null==r?null:e(r,"&")}}function o(t,n,e){for(var r,o,i=[],u=0,s=t.length;s>u;u++)if(x=t[u],o=x.parts.slice(0),null!=o[1]){if(r=o[1],o[1]=n[r],null!=o[1])i.push(o.join(""));else if(!x.optional)return console.error("Object has no value, for not optional part - ",r),null}else i.push(o[0]);return i.join(e)}t.prototype={constructor:t,create:function(t){var n,e;return n=o(this.route.path,t,"/"),null==n?null:this.route.query&&(e=o(this.route.query,t,"&"),null==e)?null:n+(e?"?"+e:"")}};var i=/^([^:\?]*)(\??):(\??)([\w]+)$/,u=/^([^\{\?]*)(\{(\??)([\w]+)\})?([^\s]*)?$/;return t}(),s={isAsync:!0,_done:null,_fail:null,_always:null,_isResolved:!1,_isRejected:!1,deferr:function(){this._isRejected=!1,this._isResolved=!1},resolve:function(){this._fail=null,this._isResolved=!0;var t=this._done,n=t&&t.length,e=0;if(t){for(;0!==n--;)t[e++](this);this._done=null}if(t=this._always,n=t&&t.length,e=0,t){for(;0!==n--;)t[e++](this);this._always=null}return this},reject:function(){this._done=null,this._isRejected=!0;var t=this._fail,n=t&&t.length,e=0;if(t){for(;0!==n--;)t[e++](this);this._fail=null}if(t=this._always,n=t&&t.length,e=0,t){for(;0!==n--;)t[e++](this);this._always=null}return this},done:function(t){return this._isResolved?t(this):(this._done||(this._done=[])).push(t),this},fail:function(t){return this._isRejected?t(this):(this._fail||(this._fail=[])).push(t),this},always:function(t){return this._isRejected||this._isResolved?t(this):(this._always||(this._always=[])).push(t),this}},l={instance:null,deserialize:function(t){for(var n in t)this[n]=t[n];return this},serialize:function(){return JSON.stringify(this)},fetch:null,onSuccess:null,onError:null,Static:{fetch:function(t){return(new this).fetch(t)}}},a=function(){var t=function(t){this.route=new u(t)};return e(t,l,s,{fetch:function(t){return i.get(this.route.create(t||this),this),this},save:function(t){i.post(this.route.create(this),this.serialize(),t)},onSuccess:function(t){var n=JSON.parse(t);this.deserialize(n),this.resolve(this)},onError:function(t){this.reject({error:t})}}),function(n){return new t(n)}}(),c=function(t){var n,e=t.Base,i=t.Extends,u=t.Static,s=t.Construct,l=null,a=t.Store;if(null!=e&&delete t.Base,null!=i&&delete t.Extends,null!=u&&delete t.Static,null!=s&&delete t.Construct,null!=a&&delete t.Store,null==i?i=a:Array.isArray(i)?i.push(a):i=[i,a],null==e&&null==i){if(l=null==s?function(){}:s,t.constructor=l.prototype.constructor,null!=u)for(n in u)l[n]=u[n];return l.prototype=t,l}if(l=function(){if(null!=i)for(var t=i instanceof Array,n=t?i.length:1,r=null,o=0;t?n>o:1>o;o++)r=t?i[o]:i,"function"==typeof r&&r.apply(this,arguments);if(null!=e&&e.apply(this,arguments),null!=s){var u=s.apply(this,arguments);if(null!=u)return u}return this},null!=u)for(n in u)l[n]=u[n];return null!=e&&o(l,e),null!=i&&o(l,i),r(l,e,i,t),t=null,u=null,l};c.bind=function(t){for(var n,e=arguments,r=1,o=arguments.length;o>r;r++)n=e[r],t[n]=t[n].bind(t);return t},c.Remote=a,t.Class=c})("undefined"!=typeof window&&null!=window.document||"undefined"==typeof global?window:global);